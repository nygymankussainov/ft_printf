/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   print_decimal.c                                    :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: vhazelnu <vhazelnu@student.42.fr>          +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2019/07/07 09:56:52 by vhazelnu          #+#    #+#             */
/*   Updated: 2019/07/15 15:43:04 by vhazelnu         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "ft_printf.h"

// char	*print_decimal_2(char *res, char *tmp, char *mant, int exp_i)
// {
// 	char		*c;
// 	char		*tmptmp;
// 	int			i;
// 	int			j;
// 	int			k;

// 	tmptmp = ft_itoa(ft_power(5, 24));
// 	while (*mant)
// 	{
// 		tmptmp = longmulti(tmptmp, "5", c);
// 		if (*mant == '1')
// 		{
// 			i = 0;
// 			j = ft_strlen(tmptmp);
// 			k = 0;
// 			while (tmptmp[k])
// 			{
// 				while (j < -exp_i)
// 				{
// 					i++;
// 					j++;
// 				}
// 				tmp[i] = tmptmp[k];
// 				i++;
// 				k++;
// 			}
// 			res = longadd(res, tmp);
// 			ft_bzero(tmp, ft_strlen(tmp));
// 		}
// 		mant += 1;
// 		exp_i--;
// 	}
// 	return (res);
// }

void	print_decimal(char *mant, int exp_i, short isint)
{
	char		*res;
	char		*tmp;
	int			i;
	int			j;
	char		*restmp;
	char		*tmptmp;

	i = -exp_i;
	if (!*mant)
	{
		write(1, "0", 1);
		return ;
	}
	while (*mant)
	{
		i++;
		mant++;
	}
	while (*mant != '1' && i + exp_i)
	{
		i--;
		mant--;
	}
	res = (char *)ft_memalloc(sizeof(char) * (i + 1));
	ft_bzero(res, i);
	res[i + 1] = '\0';
	tmp = (char *)ft_memalloc(sizeof(char) * (i + 1));
	ft_bzero(tmp, i);
	tmp[i + 1] = '\0';
	mant = mant - (i + exp_i);
	if (isint && *mant)
	{
		while (*mant != '1')
		{
			mant++;
			exp_i--;
		}
		mant++;
	}
	if (-exp_i > 27)
	{
		i = 27;
		restmp = ft_itoa(ft_power(5, 27));
		while (-exp_i > i)
		{
			restmp = longmulti(restmp, "5", restmp);
			i++;
		}
		i = 0;
		j = ft_strlen(restmp);
		while (*restmp)
		{
			while (j < -exp_i)
			{
				i++;
				j++;
			}
			res[i] = *restmp;
			i++;
			restmp++;
		}
		res[i] = '\0';
		exp_i--;
	}
	else
	{
		restmp = ft_itoa(ft_power(5, -exp_i));
		while (*mant)
		{
			if (*mant == '1')
			{
				i = 0;
				tmptmp = ft_itoa(ft_power(5, -exp_i));
				j = ft_strlen(tmptmp);
				while (*tmptmp)
				{
					while (j < -exp_i)
					{
						i++;
						j++;
					}
					tmp[i] = *tmptmp;
					i++;
					tmptmp++;
				}
				res = longadd(res, tmp);
				ft_bzero(tmp, ft_strlen(tmp));
			}
			mant += 1;
			exp_i--;
		}
	}
	// res = print_decimal_2(res, tmp, mant, exp_i);
	// printf("cmp: %d\n", ft_strcmp(res, "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033621031431120935062626778173217526025980793448464712401088272298087426993907289670430927063650562228625019066688234732270901114717276781407474941951906317291667263914849985862188944930687409323125831866998598274849771544717184727313601020971099698463135440876469200797239241480026897930318750147982625342102921480784734670183910844877343074218035130735386727359319586864183119594415952342021643481184724918445974342798057717432875401545387039208414199207016951245604150245692756494066995389002475952476953173217650675731031815971385312169349464407147507251828183432509530216565672119543732021214291185065959457965553523116044448747927683927614856579652322162887905681587885252302898430038391645430675013190288255385619643217130762140229031293434828367361764900794271003752441808130400922610625259498709247351358206365850547331123745239551865672906454195066413651996831016801426872885689784569212050810523376156603102047779014508494074609132172024837610209534374471536565953624361836633946082424911061380079367029527780610132541872124406677743897837558036437063651102355419200149640559363170081609821123344001893115860424454490218589209093120314587857551282477234161726799731447512445622414330244328593369119149123214659454020198195234127338829319770515266439445556551333025153546219948962126301964873694223394585676248581347433959489455532011876830231729249993956540433576029891747995396838287308850772976121050225933374858273582635161875702668268432647422400903439025451769081518836647226939357684503518718183054484676737812595299034991637942419099448431385735867393683448289175717476774715295024482844187030265509429083768376716790830902889917149851981056688388629538175350813073924850241761982971069079934093126248589311033958605807006335376068245062311092965586702474418993040290609154829474154510460824968302961645987941990102591723853180596353429115311751767505418252966606172611909085632279182382622037182038155917151536557064323930065527802124259315988688238008389941477005561032436681575320771658002014483387967240569120860196217670221573166925469641390263112262110000274926052124627009809802421770303897347203517306511257993983220353090003290577614339184453996856749789316419544155611174617068433199534034312862039238485154808854294314480750772190677535268703495401108303218457449600872279237329275655933088988292016100431885824229592226843340867411491081529218857248536527272599801825035025484543165136370427135656153232937486360637316843721262943439965287808248678905182091428178544495917319060813210627829936951961607601702334816202895083270977192985906171053867383536271149507801466868345084242373660483846435627042818388973527686755441778052280482900079416768703666853404221042168777301416137708992832087705404074227892079520176643005168917571930289117341953423581744915661620920272865669976574257095946317997765927992765038156052214323139785516097259851277458363424307307043700334537365060461840547851518188145115060034464047378911979153573920156634959557193964056300890745487778857970967030566288578865571927315905931649230971366752107722556294095349844862058270958818523950097214032381490066179019128618932094763460895827401465979176354643703568051276268716661718074568525237339789100827507747200377526599363824327667883849092742102553900277752841924351567409490219300946090053353096591562571137209996852946815969078995970594929976894723669521489132557581200997278049046121007054585700999160104236759623210762404445772701180239471644613791658294267901154930616218547098183031154591036158063705491889840374218499937862460219799036376016609743217164996242381337173982447105039184798997674800692001082282490636032806070874170294930893756368277840903791160811272294605976250028134625405350714883573121957679661230473916403545696225655841886336222732765707425848227004142069438565178683114701984811575479557156096919749676955552321987753385386363135641667401005968901060914999366307116381225194215615982295268030346105026357758873835293942637634559469958195003656898704056524410685345793821185493149998174459307040246948790212689753389421925271540239426720413305485264292912299797816598659167936945698055539633819110189337027760304541890589937712432549365871482823294982799271853547153211935653208934743329138748703814792265578252665346815280989054066122571402374799005199210673980242331873876843711303870075872829755956032956896797374619892196417607892645655476968364546144993872508646988987192967699352767109042777248450053634813858385706873092851680049322796107822710087642801368636578792912874613824004812160094370330973716311886175782802144938321649375288281434150156973654568400508168294382764286242297511724278410657148634194429027102063631783133949266080134112638824833407341982939919289733922439951256949181414169481373392211973709265591861073015293360501368820819319816592628885953291158400980740112935059804308985419505161209649374791684594260846929883965983701312884295598281794038506993708290342397624544850473778748425081571890270689172932802628000682252983972078141008226687803932087594456694360766836747120357523988019990026580421852454909392984242781693852184565854957363667372369195647707418194325420630075129133928535344887744717061472997859099521330486820561548473361616128221557559608820668534041826092566286300678554483072044113387601302344977544511549909450020270840108560916018969048199801049727015679399321112363226010696804239853019977629024632850566927266305157558974599209373691967846759032705913613727678645402903812668496946712192495209895117278019890656805518649784573998153642901553646491826572501719876381266645056144961508224442641743500704899714103798702625997249541914410568736623372965211580644698338408602804846783310626742392853900194863599419650447175791564001237942813875266868702430391965388693596963687059804387083320352110166915919924876724915616744282013801877455816464257023185942055109938289332295328140771466275521702279398956768893085707311411382305121347903470235006266953301781490333638363860150676119633970908198496243568881917283839449703316444581247562052139720916211015165629106830807139702202622042424098224662909540036600063506332675792493698734806294546049624282286500581144775404435180885701322086094170796604331223775727874229768210805165136951586007683974519913702454447297105597577079009193316452540220696513318099545080192750987197019468506097256962885018823953256867648982938120168548825173266603483825406111849847183994675328745526683158950219253693231117393584743306929631258973902090678269834180874144142148067562577765792982425521267148319613750198163262914968339906612582655281602494613067885566898223401654167396393082352052570222941741137123302528634451674972610491983203819647557686274985773076458102183961653968710236557178768045672808021242785302650267490870400641809455495238456488059149161028806792775306655222505308057797431875351611096506724046036277567128792952552053021568361701663808091836161396545334721760321186066910849413030835901138069095698149877048016843334763927390211473397502078125803157439422187629476773826739733098440529305842259052532623746800518064225771952591775857374539978641703070726572613303687406189980321039332499389223116881344721840238943584801398944396613713830251005454339327364217734169583114617969345357347620722945279314805392529171308104067682147693425486964992383385517902523250679907676784264787898082052810086892550452968993358363494258194480587884260801531925398287960253426912717660738023953009275543383365917379836421749788570425076930637591436528215467577773333739699511708183725691943880516846488305814985026852813679611615053755441532136513490625965925117961210156835124408644052153703499307205683864287019413498809036910467231873540413360389984853135017622892253276903249074410336562443967712673375748296981045862019397621244096451938651574712756263781806707181150399010907858634520149790127520609177431625331314521160571892720122662945864971548865489098747343545555207961604483896579595613007973073691350864102431230735806348202744391929640213514906462625373207079219259589327368783816400460747854161420043293241175778585920047019656533787829172005967985014865570261753421374255505845075060237227295313345470111709087614300132003486927689448436289857318590191267468946410695293053789347366653201236783863507591594684044930377991500290520654043141493792685904913078251576428544682776887020568596143398488107710806552701460697091365341091926056375248307040211374913925551945338312056640598237823924378098542192155647641780086976012592628186728850540050735837823827291587596007381396930971731695181639423202704472304227721426354289640452291987572373133398705603515162822874435854860696666220859580663845150268541348063094232019895154468843552230764280755462626895805082634605713734245299163110923321120423533792717254305999019550744155136388971639764992261098999612957001529210796214978861179370904761497237177959426772365441811188464977793139656854488309493466792385506706367487824092464235121821352062581796711831534240869020462051089194376149471856860252728093066614092681538581785022123388107041665451252951129840128659027527319598435340189972185873428762477296711231536006719920708512531287414118039206456403487704596160497123243868549751440126914324024596449520810427185769193814815557839343048980895034010385523790761666908586328092637132734484832333876057325845345291927345037673847302414921972181710310815860470008261518986697144736396638259523243253274773281225961015703892612668314611884902185938400468027559945281973949911586330305416503546771640142337823246432654336769848713462296690356358980341790529662374494670725647735073539680483889036270186583131092648816901754640559938973592417321653093811404867910830533745179590200827299217077414983729836694677243542887374992253903453242682578389933641745203994467466746781854451651375573523099450775187649046525528316663889407986122805626376768549440005356641573657311703178141972951914813700095541596488516554602889210209559325116482149274730422346257092919694079471802208547211443257035066157884578914319144179959952207019028548998232243676336967753117192213212903966575328079521385145904557188751208286365157012519874430758911985241984434596021119723096171338672342017819462609637748634113762945440155972489666268487560685328799795996212832159726195845448439353526585047229096333830269102915840123966374638717755633764139393952655033513354383279150418282371524276645361206188460779486639957883803864360217837876265174310927119932825713036046299079033196728201289219438568870396377362366125522107233459011137001674419684520483460088346648436911142590515474924783155695900070268259803685968845339090609204805992552225847799546885381457333848011241786039217749921908767557162673222580922678928085312960080630177628807695543955324555093993657432057792441664581022250698554369039321372462903735476853176116163262982964091359850452630935710399494974804433736578506807984703889139245017287878204838651028417934134765173844101408186912739898523074795356839427006487951447113483536344464378430707114154413838525043657991134313459908415148690527128082306909459267068745812866123751472758384980280649224662257930787520217416065251347215828404887042965797560009575730232316913979120702884449007787726741389445284073659657748558802676673755184469509117978810090927009838888848249243472182532852086153364329524084037103349259965330730389791953442916415173916493754879715087164695366900759173965758946446565468864589979419559841958969892417030678188893944025039672851562500000000000000000000000000000000"));
	ft_putstr(res, 0);
	free(res);
	free(tmp);
}
